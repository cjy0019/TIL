# 네트워크 TIL 🥳



## HTTP와 연계하는 웹 서버



### 1. 가상호스트(Virtual Host)

가상호스트란 싱글 서버에서 여러 개의 도메인 이름으로 호스팅하기 위한 방법이다.

**즉, 가상 호스트 설정으로 하나의 웹 서버로 여러 웹사이트를 운영할 수 있다.** 인터넷에서 도메인명은 DNS에 의해서 IP 주소로 변환되고 나서 액세스하게 되는데, 리퀘스트가 서버에 도착한 시점에는 IP 주소를 기준으로 액세스하게 된다.

이 때 1대의 서버에 두 개의 다른 도메인이 있을 경우 어디에 대한 엑세스인지 알 수 없기 때문에 HTTP 리퀘스트를 보내는 경우엔 호스트명과 도메인 명을 완전하게 포함한 URI를 지정하거나 Host 헤더 필드에서 지정해야 한다.

기본 문법 `Host : <host>:<port>`

실제 Request 예시)

```http
GET /pub/WWW/TheProject.html HTTP/1.1
				Host : www.w3.org
```



### 2. Proxy(프록시)란?

Proxy란 컴퓨터 네트워크에서 다른 서버상의 자원을 찾는 클라이언트로부터 요청을 받아 중계해주는 서버를 말한다.

간단히, 말해 중계서버라고 할 수 있다.

<img src="https://blog.kakaocdn.net/dn/d00mfw/btqAZNSM5mm/itEXKwSCkc9NDJ8Ck269Zk/img.png" width="40%"/>

	#### 2.1 Proxy 사용 목적

1. 익명으로 컴퓨터를 유지한다.
2. 네트워크 서비스나 콘텐츠로의 접근 정책을 적용하기 위해 사용.
3. 보안 및 통제를 뚫고 나가기 위해 사용.
4. 악성 코드를 목적으로 전달된 콘텐츠를 검사하기 위해 사용.
5. 밖으로 나가는 컨텐츠를 검사하기 위해 사용.



#### 2.2 Proxy 원리(캐싱 프록시)

1. 웹 브라우저에 도메인을 입력한다.
2. 리퀘스트는 내부에서 캐시 역할을 하는 프록시 서버로 전달.
3. 프록시 서버는 우선 자신이 해당 리퀘스트 페이지의 index 페이지를 가지고 있는지 체크.
4. 가지고 있지 않다면 외부회선을 통해 해당 페이지가 존재하는 오리진(Origin)서버와 연결하여 index 페이지를 가져옴.
5. 가지고 있다면 해당 페이지가 있는 오리진(Origin)서버에게 자신이 가진 페이지가 최신 버전인지 체크.
6. 최신이 아닌 경우 새로 갱신된 부분을 가져온다.



#### 2.3 Proxy 여러 개

프록시 서버를 여러 대 경유하는 것도 가능한데 다음과 같이 헤더 필드에 경유한 호스트 정보를 추가해야 한다.

```http
GET /HTTP/1.1

HTTP/1.1 200 OK
Via: proxy2, proxy1
```



### 3. 게이트웨이

게이트웨이는 프록시와 유사하게 **한 네트워크에서 다른 네트워크로 이동하기 위하여 거쳐야 하는 지점이다.** 

서로 다른 네트워크를 연결해준다. 서로 다른 네트워크의 프로토콜이 다를 경우에 중재 역할을 해준다고 볼 수 있다.



### 4. 터널

터널은 요구에 따라서 다른 서버와의 통신 경로를 확립합니다.

이 때 클라이언트는 SSL 같은 암호화 통신을 통해 서버와 안전하게 통신을 하기 위해 사용한다. 터널 자체는 HTTP 리퀘스트를 해석하지 않고 그대로 다음 서버에 중계한다. **터널은 통신하고 있는 양쪽 끝의 접속이 끊어질 때 종료된다.**



### 5. 캐시

**캐시란 프록시 서버와 클라이언트의 로컬 디스크에 보관된 리소스의 사본을 의미한다.**

